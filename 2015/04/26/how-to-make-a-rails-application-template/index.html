<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link href="/stylesheets/base-fd5c7397.css" rel="stylesheet" type="text/css" />
  <title>Ryan Swapp - How to Make a Rails Application Template</title>
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47580414-1', 'auto');
  ga('send', 'pageview');

  </script>
</head>
<body>
<div class="overlay overlay-door">
  <button class="overlay-close">Close</button>
    <nav>
      <ul class="menu">
        <li><a href="/">HOME</a></li>
        <li><a href="/about">ABOUT</a></li>
      </ul>
    </nav>
</div>
<div class="bg-1">
<a id="trigger-overlay" class="button button--wayra button--border-medium button--text-upper button--size-s button--text-thick button--inverted">
 <i class="fa fa-bars"></i>
</a>
</div>

<div id="main" role="main">
  <div class="container">
    <div class="row">
      <div class="nine columns blog-content">
        <h1>How to Make a Rails Application Template</h1>

<p>Rails application templates are a beautiful thing. They serve one purpose: making your life easier. Anyone who has been building Rails applications for a short amount of time surely has wished that they could speed up the process of starting a new project. Now you can! With Rails application templates you can run one command and start with a project that is filled with all the gems, files, and code that you could ever want. Let me give you an example. Lets say we have a template called bootstrap.rb that starts a new project and adds bootstrap styling, a bootstrap menu, and other features. Here is how we would use this template if it was hosted on my website:</p>
<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>rails new blog -m http://ryanswapp.com/bootstrap.rb
</pre></td></tr></tbody></table>
</div>

<p>As you can see, in addition to the default <code>rails new app_name</code> command I added the -m flag followed by the location of the template. Once you hit enter, any setup tasks that your file has declared will be run and you will be sitting pretty. I love using rails application templates for test apps because I can load it full of awesome stuff (bootstrap) in one command and not have to waste time I don&rsquo;t have making a test app less ugly.</p>

<p>Now that we know how to use a template, let’s build one!</p>

<h2>Building a Rails Application Template</h2>

<p>Rails templates use the Thor library (a toolkit for building command-line interfaces) to add/remove files and make changes to existing files. I will show you some of the basic features of Thor as we build this template.</p>

<p>As I stated before, we are going to create a template that will create a bootstrap starter app. In any directory on your computer, create a file called <code>bootstrap.rb</code>. I placed my file here:</p>
<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>code/rails/application-templates/bootstrap.rb
</pre></td></tr></tbody></table>
</div>

<p>The first thing we are going to do is add a few gems. This is quite easy to do:</p>
<div class="highlight ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="c1"># Add bootstrap and autoprefixer gems</span>

<span class="n">gem</span> <span class="s2">"bootstrap-sass"</span>
<span class="n">gem</span> <span class="s2">"autoprefixer-rails"</span>

<span class="c1"># Add rails factor gem for heroku</span>

<span class="n">gem_group</span> <span class="ss">:production</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s2">"rails_12factor"</span>
<span class="k">end</span>
</pre></td></tr></tbody></table>
</div>

<p>As you can see, adding gems to an application template is almost the same as adding them to a Gemfile.</p>

<p>Next, we want our application template to install these gems. Add this after the previous code:</p>
<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>run "bundle install --without production"
</pre></td></tr></tbody></table>
</div>

<p>You can run bash commands with the run command! I added “–without production” to the command because we don’t want the rails_12factor gem to be used in development.</p>

<p>Note: you don’t ever have to add “–without production” to bundle again after the first time you run the command. Rails will automatically do this for you.</p>

<p>Our next step is to remove the README.rdoc file and replace it with a markdown version:</p>
<div class="highlight ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="c1"># Fix the README</span>

<span class="n">remove_file</span> <span class="s2">"README.rdoc"</span>

<span class="n">create_file</span> <span class="s1">'README.md'</span> <span class="k">do</span> <span class="o">&lt;&lt;-</span><span class="no">TEXT</span><span class="sh">
# Ya Bits

This is a simple rails app with bootstrap!
</span><span class="no">TEXT</span>
<span class="k">end</span>
</pre></td></tr></tbody></table>
</div>

<p>Thor gives us the <code>remove_file</code> and <code>create_file</code> methods. When you create a new file with Thor, you can pass any text you want to a block as shown above.</p>

<p>We will now set our app up to use bootstrap. First, we need to remove the <code>application.css</code> file and create a new <code>application.css.scss</code> file. Like we saw before, I am using the <code>create_file</code> method to insert some text into the file. I’ve imported the bootstrap-sass files at the top and then threw in some CSS classes. Lastly, I add bootstrap to the <code>application.js</code> file with the <code>insert_into_file</code> method. This method has three parameters: (1) the file we want to insert something into; (2) the text we want to insert; and (3) where we want the text to be inserted. Notice that I am using a regular expression to find the <code>require_tree .</code> directive in the <code>application.js</code> file. Thor provides the <code>:before</code> and <code>:after</code> helpers to allow you to choose whether the text is inserted before or after the text in the regular expression.</p>
<div class="highlight ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></td><td class="code"><pre><span class="c1"># Begin adding bootstrap to application</span>

<span class="n">remove_file</span> <span class="s1">'app/assets/stylesheets/application.css'</span>

<span class="n">create_file</span> <span class="s1">'app/assets/stylesheets/application.css.scss'</span> <span class="k">do</span> <span class="o">&lt;&lt;-</span><span class="no">TEXT</span><span class="sh">
  @import "bootstrap";
  @import "bootstrap-sprockets";


  body {
    padding-top: 50px;
  }

  // Helper classes

  .center {
    text-align: center;
  }

</span><span class="no">TEXT</span>
<span class="k">end</span>

<span class="n">insert_into_file</span><span class="p">(</span><span class="s1">'app/assets/javascripts/application.js'</span><span class="p">,</span> <span class="s2">"//= require bootstrap-sprockets</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="ss">:before</span> <span class="o">=&gt;</span> <span class="sr">/\/\/= require_tree ./</span><span class="p">)</span>
</pre></td></tr></tbody></table>
</div>

<p>Now we will use the rails generator to create a Pages controller with a home action. We remove the <code>home.html.erb</code> file and then create a brand new one so we can start fresh. I’ve added a simple bootstrap jumbotron to the home file. Lastly, we make the home page the root path.</p>
<div class="highlight ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><pre><span class="c1"># Create a home page</span>

<span class="n">generate</span><span class="p">(</span><span class="ss">:controller</span><span class="p">,</span> <span class="s2">"pages home"</span><span class="p">)</span>

<span class="n">remove_file</span> <span class="s1">'app/views/pages/home.html.erb'</span>

<span class="n">create_file</span> <span class="s1">'app/views/pages/home.html.erb'</span> <span class="k">do</span> <span class="o">&lt;&lt;-</span><span class="no">TEXT</span><span class="sh">
&lt;div class="jumbotron center"&gt;
  &lt;h1&gt;Ya Bits!&lt;/h1&gt;
  &lt;p&gt;Thanks for using the bootstrap application template.&lt;/p&gt;

&lt;/div&gt;
</span><span class="no">TEXT</span>
<span class="k">end</span>

<span class="c1"># Make the home page the uh... home page?</span>

<span class="n">route</span> <span class="s2">"root 'pages#home'"</span>
</pre></td></tr></tbody></table>
</div>

<p>I like to start off with a basic bootstrap menu when I’m building starter applications so lets add that as well. We will create a header partial and then insert it into <code>application.html.erb</code>.</p>
<div class="highlight ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></td><td class="code"><pre><span class="c1"># Add bootstrap navigation</span>

<span class="n">create_file</span> <span class="s1">'app/views/layouts/_header.html.erb'</span> <span class="k">do</span> <span class="o">&lt;&lt;-</span><span class="no">TEXT</span><span class="sh">
&lt;nav class="navbar navbar-default navbar-fixed-top" role="navigation"&gt;
  &lt;div class="container-fluid"&gt;
    &lt;!-- Brand and toggle get grouped for better mobile display --&gt;
    &lt;div class="navbar-header"&gt;
      &lt;button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"&gt;
        &lt;span class="sr-only"&gt;Toggle navigation&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
      &lt;/button&gt;
      &lt;%= link_to 'Ya Bits', root_path, class: 'navbar-brand' %&gt;
    &lt;/div&gt;

    &lt;!-- Collect the nav links, forms, and other content for toggling --&gt;
    &lt;div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"&gt;
      &lt;ul class="nav navbar-nav navbar-right"&gt;
        &lt;li class="&lt;%= 'active' if current_page?(root_path) %&gt;"&gt;&lt;%= link_to 'Home', root_path %&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/nav&gt;

</span><span class="no">TEXT</span>
<span class="k">end</span>

<span class="n">insert_into_file</span> <span class="s1">'app/views/layouts/application.html.erb'</span><span class="p">,</span> <span class="s2">"&lt;%= render 'layouts/header' %&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="ss">:after</span> <span class="o">=&gt;</span> <span class="sr">/&lt;body&gt;/</span>
</pre></td></tr></tbody></table>
</div>

<p>Ok! We are nearing the end. Let’s also insert the HTML5 Shim and meta tags that bootstrap likes.</p>
<div class="highlight ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="c1"># Add meta tags and html5 shim</span>

<span class="n">insert_into_file</span> <span class="s1">'app/views/layouts/application.html.erb'</span><span class="p">,</span> <span class="ss">:after</span> <span class="o">=&gt;</span> <span class="sr">/&lt;%= csrf_meta_tags %&gt;/</span> <span class="k">do</span> <span class="o">&lt;&lt;-</span><span class="no">TEXT</span><span class="sh">
  &lt;meta charset='utf-8'&gt;
  &lt;meta http-equiv='X-UA-Compatible' content='IE=edge'&gt;
  &lt;meta name='viewport' content='width=device-width, initial-scale=1'&gt;
  &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;
  &lt;!-- WARNING: Respond.js doesn't work if you view the page via file:// --&gt;
  &lt;!--[if lt IE 9]&gt;
  &lt;script src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js'&gt;&lt;/script&gt;
  &lt;script src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js'&gt;&lt;/script&gt;
  &lt;![endif]--&gt;
</span><span class="no">TEXT</span>
<span class="k">end</span>
</pre></td></tr></tbody></table>
</div>

<p>As you can see, the <code>insert_into_file</code> method also takes a block into which we can add any text that we’d like. The last thing that we need to do is add this new application to git. I use Rubymine and need to add <code>.idea/</code> to the <code>.gitignore</code> file so that Rubymine’s files don’t mess with git. In addition, I tell rake to create a new database for me because I generally use postgresql.</p>
<div class="highlight ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><pre><span class="c1"># I use postgresql most of the time so this will create the database for me</span>

<span class="n">rake</span><span class="p">(</span><span class="s2">"db:create"</span><span class="p">)</span>

<span class="c1"># Add rubymine files to gitignore</span>

<span class="n">insert_into_file</span> <span class="s1">'.gitignore'</span><span class="p">,</span> <span class="ss">:after</span> <span class="o">=&gt;</span> <span class="sr">/\/tmp/</span> <span class="k">do</span> <span class="o">&lt;&lt;-</span><span class="no">TEXT</span><span class="sh">

# Ignore Rubymine files
.idea/

</span><span class="no">TEXT</span>
<span class="k">end</span>

<span class="c1"># Commit that ish to git</span>

<span class="n">run</span> <span class="s2">"git init"</span>
<span class="n">run</span> <span class="s2">"git add -A &amp;&amp; git commit -m 'Initial Commit'"</span>
</pre></td></tr></tbody></table>
</div>

<p>That’s it folks! Feel free to check out the <a href="http://www.rubydoc.info/github/erikhuda/thor/master/Thor/Actions#insert_into_file-instance_method">Thor</a> documentation as there are many more things you can use it for. In addition, the <a href="http://edgeguides.rubyonrails.org/rails_application_templates.html">edge guides</a> can be helpful as well.</p>

<p>If you have any questions please feel free to leave me a comment! The github repository for this file is here.</p>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES * * */
            var disqus_shortname = 'ryanswapp';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
      </div>
      <div class="three columns">
        <aside class="sidebar">
          <h5>Recent Articles</h5>
          <ol>
                <li><a href="/2015/04/26/how-to-make-a-rails-application-template/">How to Make a Rails Application Template</a> <span>Apr 26</span></li>
                <li><a href="/2015/04/25/simple-package-for-adding-a-url-shortener-to-a-meteor-app/">Simple package for adding a url shortener to a Meteor app</a> <span>Apr 25</span></li>
                <li><a href="/2015/02/26/build-a-blog-with-middleman-and-host-on-github-pages/">Build a Blog with Middleman and Host on Github Pages</a> <span>Feb 26</span></li>
                <li><a href="/2015/02/20/welcome-to-swappticon/">Welcome to SWAPP.SEXY</a> <span>Feb 20</span></li>
          </ol>

          <h5>Tags</h5>
          <ol>
                <li><a href="/tags/announcement/">announcement (1)</a></li>
                <li><a href="/tags/ruby/">ruby (2)</a></li>
                <li><a href="/tags/javascript/">javascript (1)</a></li>
          </ol>

          <h5>By Year</h5>
          <ol>
                <li><a href="/2015/">2015 (4)</a></li>
          </ol>
        </aside>
      </div>
    </div>
  </div>
</div>

<script src="/javascripts/modernizr.custom-b2be4ef8.js" type="text/javascript"></script>
<script src="//use.typekit.net/osk0qrt.js"></script>
<script>try{Typekit.load();}catch(e){}</script>
<script src="/javascripts/all-c722bed9.js" type="text/javascript"></script>
</body>
</html>
